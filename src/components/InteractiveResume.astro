---
import {Image} from 'astro:assets'
import tigerPfp from '../assets/tiger-pfp.jpg'
import zenadminLogo from '../assets/resume/zenadmin-logo.jpeg'
import greedygameLogo from '../assets/resume/greedygame-logo.jpeg'
import tellephantLogo from '../assets/resume/tellephant-logo.jpeg'

interface Role {
  title: string
  period: string
  responsibilities?: string[]
}

interface Experience {
  company: string
  companyUrl: string
  logo: ImageMetadata
  tenure: string
  roles: Role[]
}

interface SkillGroup {
  category: string
  skills: string[]
}

interface Education {
  degree: string
  institution: string
  period: string
}

// Resume Data
const resumeData = {
  profile: {
    name: 'Soham Sarkar',
    title: 'Software Engineer',
    avatar: tigerPfp,
    pdfUrl: 'https://assets.sohamsarkar.com/resume.pdf',
  },

  experiences: [
    {
      company: 'ZenAdmin',
      companyUrl: 'https://zenadmin.ai/',
      logo: zenadminLogo,
      tenure: 'Jul 2022 - Present 路 3 yrs 1 mo',
      roles: [
        {
          title: 'Technical Lead',
          period: 'Apr 2024 - Present',
          responsibilities: [
            'Lead a team of 5 frontend engineers, driving architecture decisions and code quality standards',
            'Spearhead hiring initiatives, conducting technical interviews and growing the frontend team',
            'Architect scalable frontend solutions serving enterprise clients with complex workflow requirements',
          ],
        },
        {
          title: 'Senior Software Engineer',
          period: 'Apr 2023 - Apr 2024',
          responsibilities: [
            'Owned end-to-end feature development for core product modules, improving user engagement',
            'Optimized application performance, achieving 40% faster load times through code splitting and lazy loading',
            'Mentored junior developers through code reviews and pair programming sessions',
            'Scaled our internal UI library to support new design patterns and components for different products',
          ],
        },
        {
          title: 'Founding Engineer',
          period: 'Jul 2022 - Apr 2023',
          responsibilities: [
            'Shipped production-ready MVP in 2 months using React, enabling first customer onboarding',
            'Architected and built internal UI library to standardize component design and improve development velocity',
            'Designed CI/CD pipeline with GitHub Actions, S3, CloudFront, and Route 53, reducing deployment time by 80%',
            'Developed backend APIs with Node.js to support core product functionality',
            'Established coding standards, testing practices, and tooling that became team-wide conventions',
          ],
        },
      ],
    },
    {
      company: 'GreedyGame',
      companyUrl: 'https://greedygame.com/',
      logo: greedygameLogo,
      tenure: 'Sep 2021 - Jul 2022 路 11 mos',
      roles: [
        {
          title: 'Frontend Developer',
          period: 'Sep 2021 - Jul 2022',
          responsibilities: [
            'Developed analytics dashboards for publishers with interactive data visualizations using D3.js and Chart.js',
            'Boosted Lighthouse performance scores from 60 to 90+ across landing pages, improving SEO rankings',
            'Migrated build tooling from Webpack to esbuild, reducing build times by 70% (from 3min to 45s)',
            'Contributed reusable components to internal UI library (GG-UI), accelerating team velocity',
            'Built internal microservices using Go for data processing workflows',
            'Mentored 3 interns on React best practices, code review processes, and clean architecture',
          ],
        },
      ],
    },
    {
      company: 'Tellephant',
      companyUrl: 'https://www.linkedin.com/company/tellephanthq/',
      logo: tellephantLogo,
      tenure: 'Mar 2021 - Aug 2021 路 6 mos',
      roles: [
        {
          title: 'Full Stack Developer',
          period: 'Mar 2021 - Aug 2021',
          responsibilities: [
            'Architected and launched buyer-facing e-commerce platform from scratch using Next.js and TypeScript',
            'Drove 3x revenue growth through UX improvements and checkout flow optimization',
            'Built reusable React component library, reducing feature development time by 40%',
            'Developed RESTful APIs with Node.js and integrated third-party payment gateways',
            'Mentored 2 interns on frontend architecture patterns and development best practices',
          ],
        },
      ],
    },
  ] as Experience[],

  skills: [
    {
      category: 'Frontend',
      skills: [
        'React',
        'Next.js',
        'TypeScript',
        'JavaScript',
        'Svelte',
        'Solid',
        'Astro',
        'HTML',
        'CSS',
        'SASS',
        'TailwindCSS',
      ],
    },
    {
      category: 'Backend & Database',
      skills: ['Node.js', 'Express.js', 'GraphQL', 'Go', 'Go Echo', 'PostgreSQL', 'MongoDB'],
    },
    {
      category: 'Tools & Infrastructure',
      skills: ['AWS', 'Git', 'Github Actions', 'Vite', 'Webpack', 'CI/CD', 'Docker'],
    },
  ] as SkillGroup[],

  education: [
    {
      degree: 'B. Tech',
      institution: 'PES University, Bengaluru',
      period: '2017 - 2021',
    },
    {
      degree: 'CBSE PCMC (12th)',
      institution: 'Ekya Schools, Bengaluru',
      period: '2015 - 2017',
    },
    {
      degree: 'CBSE PCMC (10th)',
      institution: 'Vagdevi Vilas Schools, Bengaluru',
      period: '2004 - 2015',
    },
  ] as Education[],
}
---

<div class='resume-wrapper'>
  <div class='resume-header'>
    <div class='avatar'>
      <Image src={resumeData.profile.avatar} alt={resumeData.profile.name} width={80} height={80} />
    </div>
    <div class='header-content'>
      <h1 class='name'>{resumeData.profile.name}</h1>
      <p class='title'>{resumeData.profile.title}</p>
    </div>
    <a href={resumeData.profile.pdfUrl} target='_blank' class='download-btn'> Download PDF </a>
  </div>

  <div class='resume-nav'>
    <button class='nav-btn active' data-section='experience'>Experience</button>
    <button class='nav-btn' data-section='skills'>Skills</button>
    <button class='nav-btn' data-section='education'>Education</button>
  </div>

  <div class='resume-content'>
    <!-- Experience Section -->
    <div class='section active' data-section='experience'>
      <div class='experience-list'>
        {
          resumeData.experiences.map(exp => (
            <article class='company-block'>
              <div class='company-header'>
                <div class='company-logo'>
                  <Image src={exp.logo} alt={exp.company} width={48} height={48} />
                </div>
                <div class='company-meta'>
                  <h2>
                    <a href={exp.companyUrl} target='_blank' rel='noopener noreferrer'>
                      {exp.company}
                    </a>
                  </h2>
                  <span class='tenure'>{exp.tenure}</span>
                </div>
              </div>

              <div class='roles'>
                {exp.roles.map(role => (
                  <div class='role'>
                    <div class='role-title'>
                      <h3>{role.title}</h3>
                      <span class='role-period'>{role.period}</span>
                    </div>
                    {role.responsibilities && (
                      <ul class='responsibilities'>
                        {role.responsibilities.map(resp => (
                          <li>{resp}</li>
                        ))}
                      </ul>
                    )}
                  </div>
                ))}
              </div>
            </article>
          ))
        }
      </div>
    </div>

    <!-- Skills Section -->
    <div class='section' data-section='skills'>
      <div class='skills-grid'>
        {
          resumeData.skills.map(group => (
            <div class='skill-group'>
              <h3>{group.category}</h3>
              <div class='skill-list'>
                {group.skills.map(skill => (
                  <span>{skill}</span>
                ))}
              </div>
            </div>
          ))
        }
      </div>
    </div>

    <!-- Education Section -->
    <div class='section' data-section='education'>
      <div class='education-list'>
        {
          resumeData.education.map(edu => (
            <article class='education-item'>
              <h3>{edu.degree}</h3>
              <p class='institution'>{edu.institution}</p>
              <span class='period'>{edu.period}</span>
            </article>
          ))
        }
      </div>
    </div>
  </div>
</div>

<style>
  .resume-wrapper {
    max-width: 800px;
    margin: 0 auto;
    padding: 40px 20px 80px;
    color: #fff;
    font-family: 'Victor Mono', monospace;
  }

  /* Header */
  .resume-header {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 40px;
    padding-bottom: 32px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  }

  .avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    overflow: hidden;
    flex-shrink: 0;
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .header-content {
    flex: 1;
  }

  .name {
    font-size: 2rem;
    font-weight: 500;
    letter-spacing: -0.05em;
    line-height: 1.2;
    margin-bottom: 4px;
  }

  .title {
    color: #7f7f7f;
    font-size: 1rem;
    font-weight: 400;
  }

  .download-btn {
    padding: 10px 20px;
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #fff;
    text-decoration: none;
    border-radius: 8px;
    font-size: 0.875rem;
    font-family: inherit;
    transition: all 0.2s ease;
  }

  .download-btn:hover {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.3);
  }

  /* Navigation */
  .resume-nav {
    display: flex;
    gap: 8px;
    margin-bottom: 40px;
  }

  .nav-btn {
    padding: 8px 16px;
    background: transparent;
    border: 1px solid transparent;
    color: #7f7f7f;
    border-radius: 6px;
    cursor: pointer;
    font-family: inherit;
    font-size: 0.875rem;
    transition: all 0.2s ease;
  }

  .nav-btn:hover {
    color: #a1a1aa;
  }

  .nav-btn.active {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
    color: #fff;
  }

  /* Sections */
  .section {
    display: none;
  }

  .section.active {
    display: block;
  }

  /* Experience */
  .experience-list {
    display: flex;
    flex-direction: column;
    gap: 48px;
  }

  .company-block {
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  .company-header {
    display: flex;
    align-items: center;
    gap: 16px;
  }

  .company-logo {
    width: 48px;
    height: 48px;
    border-radius: 8px;
    overflow: hidden;
    flex-shrink: 0;
    background: rgba(255, 255, 255, 0.05);
  }

  .company-logo img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .company-meta h2 {
    font-size: 1.25rem;
    font-weight: 500;
    letter-spacing: -0.02em;
    margin-bottom: 4px;
  }

  .company-meta h2 a {
    color: #fff;
    text-decoration: none;
    transition: color 0.2s ease;
  }

  .company-meta h2 a:hover {
    color: #a1a1aa;
  }

  .tenure {
    color: #7f7f7f;
    font-size: 0.875rem;
  }

  .roles {
    display: flex;
    flex-direction: column;
    gap: 24px;
    padding-left: 64px;
    position: relative;
  }

  .roles::before {
    content: '';
    position: absolute;
    left: 24px;
    top: 11px;
    bottom: 11px;
    width: 1px;
    background: rgba(255, 255, 255, 0.15);
  }

  .role {
    position: relative;
  }

  .role::before {
    content: '';
    position: absolute;
    left: -43px;
    top: 8px;
    width: 7px;
    height: 7px;
    background: rgba(255, 255, 255, 0.4);
    border-radius: 50%;
    z-index: 1;
  }

  .role-title {
    display: flex;
    flex-direction: column;
    gap: 4px;
    margin-bottom: 12px;
  }

  .role-title h3 {
    font-size: 1rem;
    font-weight: 500;
    color: #fff;
  }

  .role-period {
    color: #7f7f7f;
    font-size: 0.8125rem;
  }

  .responsibilities {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .responsibilities li {
    color: #a1a1aa;
    font-size: 0.875rem;
    line-height: 1.6;
    padding-left: 16px;
    position: relative;
  }

  .responsibilities li::before {
    content: '路';
    position: absolute;
    left: 0;
    color: #7f7f7f;
  }

  /* Skills */
  .skills-grid {
    display: flex;
    flex-direction: column;
    gap: 32px;
  }

  .skill-group h3 {
    font-size: 0.875rem;
    font-weight: 500;
    color: #7f7f7f;
    margin-bottom: 12px;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .skill-list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }

  .skill-list span {
    padding: 6px 12px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    font-size: 0.8125rem;
    color: #e5e5e5;
  }

  /* Education */
  .education-list {
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  .education-item h3 {
    font-size: 1.125rem;
    font-weight: 500;
    margin-bottom: 4px;
  }

  .education-item .institution {
    color: #a1a1aa;
    font-size: 0.9375rem;
    margin-bottom: 4px;
  }

  .education-item .period {
    color: #7f7f7f;
    font-size: 0.8125rem;
  }

  /* Responsive */
  @media (max-width: 640px) {
    .resume-wrapper {
      padding: 24px 16px 60px;
    }

    .resume-header {
      flex-wrap: wrap;
      gap: 16px;
    }

    .avatar {
      width: 64px;
      height: 64px;
    }

    .name {
      font-size: 1.5rem;
    }

    .download-btn {
      width: 100%;
      text-align: center;
      order: 3;
    }

    .roles {
      padding-left: 32px;
    }

    .roles::before {
      left: 12px;
    }

    .role::before {
      left: -23px;
    }
  }
</style>

<script>
  function initializeResume() {
    const navBtns = document.querySelectorAll('.nav-btn')
    const sections = document.querySelectorAll('.section')

    navBtns.forEach(btn => {
      btn.addEventListener('click', e => {
        const target = e.currentTarget as HTMLElement
        const targetSection = target.dataset.section
        if (!targetSection) return

        navBtns.forEach(navBtn => navBtn.classList.remove('active'))
        target.classList.add('active')

        sections.forEach(section => section.classList.remove('active'))
        const sectionEl = document.querySelector(`.section[data-section="${targetSection}"]`)
        if (sectionEl) sectionEl.classList.add('active')
      })
    })
  }

  document.addEventListener('DOMContentLoaded', initializeResume)
</script>
